package com.kfouri.opentest.extension

import com.kfouri.opentest.api.Resource
import retrofit2.Response

fun <Data> Response<Data>.parse(): Resource<Data> {
    if (this.isSuccessful) {
        return when (this.code()) {
            200 -> {
                this.body()?.let { data ->
                    Resource.success(data)
                } ?: run {
                    Resource.error(this.body(), "Error")
                }
            }
            else -> {
                Resource.error(this.body(), "Error")
            }
        }
    } else {
        val message = errorBody()?.string() ?: "unknown error"
        return Resource.error(this.body(), message)
    }
}